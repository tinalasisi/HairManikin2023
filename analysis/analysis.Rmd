---
title: "Analysis"
author: "Tina Lasisi"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  workflowr::wflow_html:
    toc: yes
    number_sections: yes
editor_options:
  chunk_output_type: console
---

```{r setup, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(tidyverse)
library(knitr)
library(fs)
library(gridExtra)
library(patchwork)
library(broom.mixed)
library(huxtable)
# knitting to pdf
# rmarkdown::render(input = "analysis/analysis.Rmd", output_format = "pdf_document", output_dir = "output")
F = rprojroot::is_rstudio_project$make_fix_file()
palettedf <- tibble(paletteer::palettes_d_names)
# filter(.data = palettedf, length > 10 & type == "qualitative")
knitr::opts_chunk$set(echo = FALSE, include = TRUE, eval = TRUE, warning = FALSE, message = FALSE, fig.retina = 2, fig.width = 8, fig.height = 6)
```

```{r functions, include=FALSE}
# This is a function to save the figures
plot_path = F("output/")
pltsave_func <- function(plot, plot_path, width, height){
  ggsave(
      filename = paste0(deparse(substitute(plot)), ".png"),
      plot = plot, 
      path = plot_path,
      width = width,
      height = height)
}

every_nth <- function(x, nth, empty = TRUE, inverse = FALSE) 
  {
  if (!inverse) {
    if(empty) {
      x[1:nth == 1] <- ""
      x
      } else {
        x[1:nth != 1]
        }
    } else {
      if(empty) {
        x[1:nth != 1] <- ""
        x
        } else {
          x[1:nth == 1]
        }
    }
}
```

```{r plot_helpers, include=FALSE}

# Plot data as as a row of bar charts, each column being a different wind speed.
dryHairColor1 = "#E69F00"
wetHairColor1 = "#0072B2"
dryHairColor2 = "#E69F00"
wetHairColor2 = "#0072B2"
dryHairColor3 = "#E69F00"
wetHairColor3 = "#0072B2"

dryHairColor = dryHairColor1
wetHairColor = wetHairColor1

radiationOnHairColor = "red"
radiationOffHairColor = "blue"


coloursList <- c(dryHairColor1, dryHairColor2, dryHairColor3, wetHairColor1, wetHairColor2)
# Name your list of colors
names(coloursList) <- c('dry_1', 'dry_2', 'dry_3', 'wet_1', 'wet_2')

coloursList2 <- c(radiationOnHairColor, radiationOnHairColor, radiationOnHairColor, radiationOffHairColor, radiationOffHairColor, radiationOffHairColor)
names(coloursList2) <- c('on_1', 'on_2', 'on_3', 'off_1', 'off_2', 'off_3')


radiation_names <- c(
  `on` = 'Radiation On',
  `off` = 'Radiation Off'
)


wind_names <- c(
  `0.3` = paste0(0.3,"~~","frac(m , s)"),
  `1` = paste0('1' ,"~~","frac(m , s)"),
  `2.5` = paste0(2.5,"~~","frac(m , s)")
)



# df_sweat_requirements['sweat_zero'][df_sweat_requirements['sweat_zero'] < 0] <- 0

```

# Preparing Data

First, we import the data and label the variables.

```{r Importing, echo=FALSE}
# Importing data

df_wetdry <- read_csv(F("data/current/Aug2022.csv"), 
    col_types = cols(
      wig = col_factor(levels = c("nude", 
        "Low_curve", "Mid_curve", "High_curve")), 
      radiation = col_factor(levels = c("off", 
            "on")),
      wet_dry = col_factor(levels = c("dry", 
            "wet")),
      trial = col_factor(levels = c("1", "2", "3")))) %>% 
  mutate(wig = factor(wig, levels = c("nude", 
        "Low_curve", "Mid_curve", "High_curve"), labels = c("Nude", 
        "Straight", "Slightly\nCurled", "Tightly\nCurled"))) %>% 
  rename(heat_loss = heatloss) %>% drop_na

df_wetdry_plots <- df_wetdry %>% 
  unite('data_points', c('radiation','trial'), remove=FALSE)

```

```{r Data Preview, echo=TRUE}
# Preview data
head(df_wetdry)
```

```{r General Plots, echo=FALSE}

raw_barplot <- ggplot(df_wetdry_plots, aes(x = wig, y = heat_loss, fill = data_points)) + 
  geom_bar(stat = "identity", position = "dodge", colour="black") + 
  facet_grid(wet_dry ~ wind, labeller = labeller(radiation = as_labeller(radiation_names),
                                                   wind = as_labeller(wind_names, label_parsed)))+ 
  scale_fill_manual(values = coloursList2, breaks = c('on_1', 'off_1'), labels = c('Radiation On', 'Radiation Off')) + 
  labs(x = "", y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )')), fill = '') + 
scale_color_discrete(guide = "none") +  theme_classic()

raw_barplot

```




```{r General Not Used, echo=FALSE, include=FALSE}

change_winds <- function(df, windCol, wigCol) {
  df[windCol] <- df[windCol] + (0.1)*(ifelse(df[wigCol] == "Nude", 0, ifelse(df[wigCol] == "Straight", -0.5, ifelse(df[wigCol] == "Slightly\nCurled", 0, 0.5))))
  return(df)
}

df_wetdry_plots <- change_winds(df_wetdry_plots, 'wind', 'wig')
# view(df_wetdry_plots['wind'])

# 
# # SCATTER PLOT
# raw_scatter <- ggplot(df_wetdry_plots, aes(x = wind, y = heat_loss, shape = wig, fill = wet_dry)) +
#   geom_point(size = 2) +
#   facet_grid(. ~ radiation, labeller = labeller(radiation = as_labeller(radiation_names))) +
#   scale_fill_manual(values = c(dryHairColor, wetHairColor)) +
#   scale_shape_manual(values = c(21,22,25,24)) + 
# 
#   scale_y_continuous(breaks= seq(0,500,25),
#     labels = every_nth(seq(0,500,25), 3, inverse = TRUE)) +
# 
#   scale_x_continuous(limits = c(0, 3), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
#   guides(fill = guide_legend(override.aes=list(shape=21))) +
#   labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )'))) +
# theme_classic() + theme( panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# 
# raw_scatter
``` 

## Removing Outlier
It was noticed that the 2nd trial conducted with wet, tightly curled hair, 2.5 m/s wind speed, and radiation on, had more heat loss than any of the trials with radiation off. With the understanding that radiation should always decrease heat loss, we elected to remove that data point.

```{r Outlier, echo=TRUE}
# Remove specific entry
df_wetdry <- df_wetdry %>% filter(!(wig == "Tightly\nCurled" & wind == 2.5 & radiation == "on" & wet_dry == "wet" & trial == "1"))

```


```{r General After Outliar Removal}
df_wetdry_plots <- df_wetdry %>% 
  unite('data_points', c('radiation','trial'), remove=FALSE)

raw_barplot_minoutlier <- ggplot(df_wetdry_plots, aes(x = wig, y = heat_loss, fill = data_points)) + 
  geom_bar(stat = "identity", position = "dodge", colour="black") + 
  facet_grid(wet_dry ~ wind, labeller = labeller(radiation = as_labeller(radiation_names),
                                                   wind = as_labeller(wind_names, label_parsed)))+ 
  scale_fill_manual(values = coloursList2, breaks = c('on_1', 'off_1'), labels = c('Radiation On', 'Radiation Off')) + 
  labs(x = "", y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )')), fill = '') + 
scale_color_discrete(guide = "none") +  theme_classic()

raw_barplot_minoutlier

manuscript_plt1 <- raw_barplot_minoutlier + coord_flip()
```

# Calculating Thermal Resistance

$$I_t = \frac{T_{Skin} - T_{Air}}{H_{Dry}}$$

```{r Thermal Resistance, echo=TRUE}

df_wetdry['dry_heat_resistance'] <- (df_wetdry['skin_temp'] - df_wetdry['amb_temp']) / df_wetdry['heat_loss']

# For the dry data, leave this blank
df_wetdry <- df_wetdry %>% mutate(dry_heat_resistance = ifelse(wet_dry == 'wet', NaN, dry_heat_resistance))

```

```{r Thermal Resistance Plots, echo=FALSE}
# Plot dry

ggplot(df_wetdry, aes(x = wig, y = dry_heat_resistance, fill = trial)) + 
  geom_bar(stat = "identity", position = "dodge", colour = "black") + 
  facet_grid(radiation ~ wind, labeller = labeller(radiation = as_labeller(radiation_names),
                                                   wind = as_labeller(wind_names, label_parsed)))+ 
  scale_fill_manual(values = c(dryHairColor1, dryHairColor2, dryHairColor3), breaks = NULL, labels = c()) + 
  labs(x = '', y = expression(paste("Dry Heat Resistance ( ", frac("m"^"2"*"K","W"), ' )')), fill = '') + 
scale_color_discrete(guide = "none") +  theme_classic()


df_wetdry_plots2 <- df_wetdry
df_wetdry_plots2 <- change_winds(df_wetdry_plots2, 'wind', 'wig')
```

```{r Thermal Resistance Plots 2, echo=FALSE, include=FALSE}
# Scatter plot dry

# ggplot(df_wetdry_plots2, aes(x = wind, y = dry_heat_resistance, shape = wig, fill = radiation)) +
#   geom_point(size = 2) +
#   scale_fill_manual(values = c('green', 'red')) +
#   scale_shape_manual(values = c(21,22,23,24)) + 
#   scale_y_continuous(breaks= seq(0,2,0.25),
#     labels = every_nth(seq(0,2,0.25), 2, inverse = TRUE)) +
#   scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
#   guides(fill = guide_legend(override.aes=list(shape=21))) +
#   labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Dry Heat Resistance ( ",  frac("m"^"2"*"K","W"), ' )'))) +
# theme_classic() + theme( panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

```

# Calculating Net Solar Influx

$$I_{Dry} = H_{Dry} - H_{Dry}^{Solar}$$ $$I_{Evap} = H_{Evap} - H_{Evap}^{Solar}$$

```{r Net Solar Influx, echo=TRUE}

# Average all trials with the same characteristics
df_averaged_trials <- df_wetdry %>%
  group_by(wig, wind, radiation, wet_dry) %>%
  drop_na(heat_loss) %>%
  summarise(heat_loss = mean(heat_loss))

# Pivot the dataframe to incldue radiation on and off as part of same event
df_radiation_split <- df_averaged_trials %>%
  pivot_wider(names_from = c(radiation), values_from = c(heat_loss)) %>% 
  rename(heat_loss_off = off) %>% 
  rename(heat_loss_on = on)

# Calculate the net influx
df_net_influx_plots <- df_radiation_split %>%
  group_by(wig, wind) %>%
  summarise(wet_dry = wet_dry,
            net_influx = heat_loss_off - heat_loss_on) 

df_net_influx <- df_net_influx_plots %>%  spread(wet_dry, net_influx)
```

```{r Net Solar Influx Plots, echo=FALSE}
plt_influx_bar <- ggplot(df_net_influx_plots, aes(x = wig, y = net_influx, fill = wet_dry)) + 
  geom_bar(stat = "identity", position = "dodge", color = "black") + 
  facet_grid(. ~ wind, labeller = labeller(wind = as_labeller(wind_names, label_parsed)))+ 
  scale_fill_manual(values = c(dryHairColor, wetHairColor), labels = c("dry", "wet")) + 
  labs(x = "", y = expression(paste("Net Solar Influx ( ", frac("W","m"^"2"), ' )')), fill = '') + 
scale_color_discrete(guide = "none") +  theme_classic()

plt_influx_bar

plt_influx_pointline <- ggplot(df_net_influx_plots, aes(x = wind, y = net_influx, shape = wig, fill = wig)) +
  geom_point(size = 3) +
  geom_line() +
  facet_grid(. ~ wet_dry,)+ 
  scale_fill_manual(values = c("red","blue","pink","orange")) +
  scale_shape_manual(values = c(21,22,23,24)) + 
  scale_y_continuous(breaks= seq(0,180,25),
    labels = every_nth(seq(0,180,25), 2, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
  # guides(fill = guide_legend(override.aes=list(shape=21))) +
  labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Net Solar Influx ( ", frac("W","m"^"2"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

plt_influx_pointline

manuscript_plt2 <- plt_influx_pointline
```

```{r Net Solar Influx Plots 2, echo=FALSE, include=FALSE}
# ggplot(df_net_influx_plots, aes(x = wind, y = net_influx, shape = wig, fill = wet_dry)) +
#   geom_point(size = 3) +
#   geom_line() +
#   scale_fill_manual(values = c(dryHairColor, wetHairColor)) +
#   scale_shape_manual(values = c(21,22,23,24)) + 
#   scale_y_continuous(breaks= seq(0,180,25),
#     labels = every_nth(seq(0,180,25), 2, inverse = TRUE)) +
#   scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
#   guides(fill = guide_legend(override.aes=list(shape=21))) +
#   labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Net Solar Influx ( ", frac("W","m"^"2"), ' )'))) +
# theme_classic() + theme( panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
```

# Adjusting Heat Losses to 30 Degrees Celsius

## Dry Heat Loss

$$H_{Dry}^{30^\circ C} = \frac{35 -30}{I_t}$$

```{r Heat Adjustments, echo=TRUE}

# Their calculation
df_wetdry['heat_30'] = (35 - 30) / df_wetdry['dry_heat_resistance']

# What I would expect
#df_wetdry['heat_30'] = (df_wetdry['skin_temp'] - 30) / df_wetdry['dry_heat_resistance']


# Recreate the radiation split dataframe to include heat_30
df_averaged_trials <- df_wetdry %>%
  group_by(wig, wind, radiation, wet_dry) %>%
  drop_na(heat_loss) %>%
  summarise(heat_loss = mean(heat_loss),
    heat_30 = mean(heat_30))

df_radiation_split <- df_averaged_trials %>%
  pivot_wider(names_from = c(radiation), values_from = c(heat_loss, heat_30))
```

## Dry and Wet Heat Losses With Solar Radiation

$$H_{Dry}^{30^{\circ} C,\:Solar} = H_{Dry}^{30^{\circ} C} - I_{Dry}$$ $$H_{Wet}^{30^{\circ} C,\:Solar} = H_{Evap + Dry}^{30^{\circ} C} = H_{Evap} + I_{Dry} + H_{Dry}^{30^{\circ} C,\:Solar}$$

```{r Losses With Radiation, echo=TRUE}

dry_heat_30 = df_radiation_split[df_radiation_split$wet_dry == 'dry',]

heat_evap = df_radiation_split[df_radiation_split$wet_dry == 'wet',]


df_adjusted_solar <- data.frame(
  dry_heat_loss <- dry_heat_30$heat_30_off - df_net_influx$dry,
  wind <- dry_heat_30$wind,
  wig <- dry_heat_30$wig
) %>% rename('dry_heat_loss' = 'dry_heat_loss....dry_heat_30.heat_30_off...df_net_influx.dry') %>%
  rename('wind' = 'wind....dry_heat_30.wind') %>%
  rename('wig' = 'wig....dry_heat_30.wig')


df_adjusted_solar['wet_heat_loss'] <-  + heat_evap$heat_loss_on + df_net_influx$dry + df_adjusted_solar$dry_heat_loss


df_adjusted_solar_plots <-df_adjusted_solar %>% 
  pivot_longer(cols = c('dry_heat_loss', 'wet_heat_loss'), names_to = 'wet_dry', values_to = 'heat_loss')
```

```{r Losses With Radiation Plots, echo=FALSE}

plt_30_solar_bar <- ggplot(df_adjusted_solar_plots, aes(x = wig, y = heat_loss, fill = wet_dry)) + 
  geom_bar(stat = "identity", position = "dodge", color = "black") + 
  facet_grid(. ~ wind, labeller = labeller(wind = as_labeller(wind_names, label_parsed)))+ 
  scale_fill_manual(values = c(dryHairColor, wetHairColor), labels = c("dry", "wet")) + 
  labs(title = 'Heat Loss with Solar Radiation at 30C', x = "", y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )')), fill = '') + 
scale_color_discrete(guide = "none") +  theme_classic()

plt_30_solar_bar

plt_30_solar_pointline <- ggplot(df_adjusted_solar_plots, aes(x = wind, y = heat_loss, shape = wig, fill = wet_dry)) +
  geom_point(size = 3) +
  geom_line() +
  scale_fill_manual(values = c(dryHairColor, wetHairColor), labels = c("dry", "wet")) +
  scale_shape_manual(values = c(21,22,23,24)) + 
  scale_y_continuous(breaks= seq(-300,400,25),
    labels = every_nth(seq(-300,400,25), 4, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
  guides(fill = guide_legend(override.aes=list(shape=21))) +
  labs(title = 'Heat Loss with Solar Radiation at 30C', x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

plt_30_solar_pointline
```

```{r Losses With Radiation Plots 2, echo=FALSE, include=FALSE, fig.cap="Heat loss with solar radiation at 30C}

plt_30_solar_pointline_panel <- ggplot(df_adjusted_solar_plots, aes(x = wind, y = heat_loss, shape = wig, fill = wig)) +
  geom_point(size = 3) +
  geom_line() +
  facet_grid(.~ wet_dry , labeller = as_labeller(c(`dry_heat_loss` = 'dry', `wet_heat_loss` = 'wet')))+ 
  scale_shape_manual(values = c(21,22,23,24)) + 
  scale_fill_manual(values=c("red","blue","pink","orange")) +
  scale_y_continuous(breaks= seq(-200,401,50),
    labels = every_nth(seq(-200,401,50), 2, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
  # guides(fill = guide_legend(override.aes=list(shape=21))) +
  labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Heat Loss ( ", frac("W","m"^"2"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

plt_30_solar_pointline_panel 

manuscript_plt3 <- plt_30_solar_pointline_panel
```



# Calculating Evaporative Potential

$$H_{Max}^{30^{\circ} C,\:Solar} = H_{Wet}^{30^{\circ} C,\:Solar} - H_{Dry}^{30^{\circ} C,\:Solar}$$

```{r Evaportative Potential, echo=TRUE}

df_evaporative_potential <- df_adjusted_solar$wet_heat_loss - df_adjusted_solar$dry_heat_loss

```

# Calculating Sweat Requirements

$$Sweat_{Max} = \frac{H_{Max}^{30^{\circ} C,\:Solar} * 3600}{2430}$$

$$ IF \; H_{Dry}^{30^{\circ} C,\:Solar} < 0, \; Sweat_{Zero} = -\frac{H_{Dry}^{30^{\circ} C,\:Solar} * 3600}{2430} \\
ELSE, \; Sweat_{Zero} = 0$$


```{r Sweat Requirements, echo=TRUE}
# Create a new df with the sweat requirements

df_sweat_requirements <- data.frame(
  sweat_max <- df_evaporative_potential * 3600 / 2430,
  sweat_zero <- -3600 / 2430 * df_adjusted_solar['dry_heat_loss'],
  wig <- df_adjusted_solar$wig,
  wind <- df_adjusted_solar$wind
)

#Rename columns
colnames(df_sweat_requirements) <- c('sweat_max', 'sweat_zero', 'wig', 'wind')


#Replace all values less than 0 with 0 per formula
df_sweat_requirements['sweat_zero'][df_sweat_requirements['sweat_zero'] < 0] <- 0
```

```{r Sweat Requirements Plots, echo=FALSE}

sweat_zero_plot <- ggplot(df_sweat_requirements, aes(x = wind, y = sweat_zero, shape = wig, fill = wig)) +
  geom_point(size = 3) +
  geom_line() +
  scale_shape_manual(values = c(21,22,23,24)) + 
  scale_fill_manual(values=c("red","blue","pink","orange")) +
  scale_y_continuous(breaks= seq(0,300,25),
    labels = every_nth(seq(0,300,25), 2, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
# guides(fill = guide_legend(override.aes=list(shape=21))) +
  labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Sweat ( ", frac("g","m"^"2"*"h"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

sweat_max_plot <- ggplot(df_sweat_requirements, aes(x = wind, y = sweat_max, shape = wig, fill = wig)) +
  geom_point(size = 4) +
  geom_line() +
  scale_shape_manual(values = c(21,22,23,24)) + 
  scale_fill_manual(values=c("red","blue","pink","orange")) +
  scale_y_continuous(breaks= seq(0,700,25),
    labels = every_nth(seq(0,700,25), 4, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
  labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Sweat ( ", frac("g","m"^"2"*"h"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


sweat_max_plot + sweat_zero_plot + plot_layout(guides = "collect") + plot_annotation(tag_levels = "A")


```


```{r plt sweat}

df_sweat_requirements_long <- df_sweat_requirements %>% 
  pivot_longer(cols = c('sweat_max', 'sweat_zero'), names_to = 'sweat', values_to = 'value')

sweat_combo_plot <- ggplot(df_sweat_requirements_long, aes(x = wind, y = value, shape = wig, fill = wig)) +
  geom_point(size = 3) +
  geom_line() +
  facet_grid(.~ sweat , labeller = as_labeller(c(`sweat_max` = 'Max', `sweat_zero` = 'Zero')))+   scale_shape_manual(values = c(21,22,23,24)) + 
  scale_fill_manual(values=c("red","blue","pink","orange")) +
  scale_y_continuous(breaks= seq(0,700,50),
    labels = every_nth(seq(0,700,50), 2, inverse = TRUE)) +
  scale_x_continuous(limits = c(0,2.7), breaks = c(0, 0.5, 1, 1.5, 2, 2.5)) +
# guides(fill = guide_legend(override.aes=list(shape=21))) +
  labs(x = expression(paste("Wind Speed ( ", frac("m", "s"), ' )')), y = expression(paste("Sweat ( ", frac("g","m"^"2"*"h"), ' )'))) +
theme_classic() + theme( panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

manuscript_plt4 <- sweat_combo_plot


```


```{r plt-combo-paper, include=FALSE}


manuscript_combo_fig <- manuscript_plt1 + manuscript_plt2 + manuscript_plt3 + manuscript_plt4 + plot_layout(guides = "collect") + plot_annotation(tag_levels = "A")

manuscript_combo_fig

pltsave_func(manuscript_combo_fig, plot_path, width = 10, height = 8)


```


